get_services_stat:
  call: http.post
  args:
    url: https://opensearch-node1:9200/services/_search/template
    body:
      id: 'get-services-stat'
      params: ${incoming.body}
  result: results
  next: check_result

check_result:
  switch:
    - condition: ${results.response.body.found === true}
      next: return_ok
  next: return_not_found

return_not_found:
  status: 404
  return: 'Opensearch index not found'
  next: end

return_ok:
  status: 200
  return: ${results.response.body._source}
  next: end
